import{f,o as m,k as g,q as b,b as c}from"./entry.3e9d827f.js";import{v as h,_ as y,f as P,p as k,s as d,i as x,g as u,c as p}from"./app-grid.vue.173d388d.js";import"./button.esm.bde35740.js";import"./AppCard.4c49263b.js";import"./inputtext.esm.464edc1b.js";const C=f({__name:"app-form-grid",props:{data:{},config:{}},setup(n){const e=n,t={title:e.config.title,basis:e.config.basis,allowUpdate:e.config.allowUpdate,allowAdd:()=>{e.data.push((e.config.newItemFunc??(()=>({})))(e.data.length))},allowDelete:o=>{var s;const r=e.data.findIndex(a=>a[e.config.dataKey]===o[e.config.dataKey]);r!==-1&&e.data.splice(r,1),(s=e.config.onDeleted)==null||s.call(void 0,o)},allowEdit:!0,props:{dataKey:e.config.dataKey,editMode:"cell",filterDisplay:void 0},emits:{"cell-edit-complete":o=>e.data[o.index][o.field]=o.newValue},getData:()=>Promise.resolve(e.data),hidePaging:!0,labels:e.config.labels,columns:{$validationOutcome:h(e.config.validationFunc),...e.config.columns}};return(o,r)=>(m(),g(b(y),{data:e.data,config:t},null,8,["data"]))}});function w(n,e){if(n.length<=e)return n;const t=n.split("?")[0],o="...",r=e-o.length,s=t.substr(-r);return o+s}function _(n){return{...P,slots:{body:({data:e,field:t})=>{const o=e[t];if(!o)return[];const r=w(o,n);return[c("a",{target:"_blank",style:"text-decoration: underline;",href:o},[r])]}}}}function v(n){const e=_(n);return{...e,slots:{...e.slots,body:({data:t,field:o})=>{const r=t[o];if(!r)return[];const s=w(r,n);return[c("span",null,[s]),c("a",{target:"_blank",style:"text-decoration: underline; margin-left: 5px",href:r},[c("i",{class:"pi pi-play"},null)])]},editor:k}}}function N(n){const e=[];return(!Number.isFinite(n.count)||n.count<1)&&e.push("Количество должно быть больше либо равно 1"),!n.url||!D(n.url)?e.push("Укажите ссылку на товар в формате https://site.com/some-product"):n.url.length>65536&&e.push("Максимальная длинна ссылки 65536"),e}function D(n){return/^(https?):\/\/(([^:\/?#\s]+)(?::(\d+))?)(\/[^?#\s]*)?(\?[^#\s]*)?(#\S*)?$/i.test(n)}const I=f({__name:"AppProductsGrid",props:{items:{},mode:{}},emits:["update"],setup(n,{emit:e}){const t=n;function o(){var i;for(let l=0;l<((i=t.items)==null?void 0:i.length);l++)t.items[l].id=l+1}const r={basis:"500px",title:"Товары от одного продавца",dataKey:"id",allowUpdate:t.mode==="moder"?()=>e("update",t.items):void 0,allowAdd:t.mode==="new",allowEdit:t.mode==="new"||t.mode==="moder",allowDelete:t.mode==="new",onDeleted:()=>o(),newItemFunc:i=>({id:i+1,count:1}),validationFunc:N,labels:{id:"#",url:"Ссылка",count:"Количество",priceToPay:"К оплате",priceNet:"Цена нетто",priceGross:"Цена брутто",priceMarkup:"Наценка"},columns:{id:d,url:t.mode==="new"?v(50):_(50),count:t.mode==="new"?x:d,priceToPay:s(t.mode),priceNet:a(t.mode),priceGross:a(t.mode),priceMarkup:a(t.mode)}};function s(i){return i==="new"?!1:i==="moder"?u:p}function a(i){return i==="moder"?u:i==="moder-ro"?p:!1}return(i,l)=>(m(),g(b(C),{config:r,data:t.items},null,8,["data"]))}});export{I as _,N as p};
//# sourceMappingURL=AppProductsGrid.vue.233153e4.js.map
