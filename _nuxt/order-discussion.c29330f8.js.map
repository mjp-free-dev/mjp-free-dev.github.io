{"version":3,"file":"order-discussion.c29330f8.js","sources":["../../../../src/pages/user/components/order-discussion.vue"],"sourcesContent":["<script setup lang=\"ts\">\r\nimport AppCard from '@/components/markup/AppCard.vue';\r\nimport OrderDiscussionMessage from './order-discussion-message.vue';\r\nimport {MessageDisplayItem, MessageService} from '@/services/message.service';\r\n\r\nconst props = defineProps<{orderId: number; mode: 'customer' | 'moder'}>();\r\nconst service = useService(MessageService);\r\nconst messages = ref([] as MessageDisplayItem[]);\r\nconst userMessage = ref('');\r\n\r\nonMounted(async () => {\r\n  messages.value = await service.getOrderMessages(props.orderId);\r\n});\r\n\r\nasync function onSubmit() {\r\n  if (!userMessage.value) {\r\n    return;\r\n  }\r\n\r\n  if (props.mode === 'customer') {\r\n    await service.addCustomerMessage(props.orderId, userMessage.value);\r\n  } else {\r\n    await service.addModerMessage(props.orderId, userMessage.value);\r\n  }\r\n\r\n  userMessage.value = '';\r\n  messages.value = await service.getOrderMessages(props.orderId);\r\n}\r\n</script>\r\n\r\n<template>\r\n  <AppCard\r\n    basis=\"700px\"\r\n    :title=\"'Обсуждение заказа #' + props.orderId\"\r\n  >\r\n    <div class=\"chat-container\">\r\n      <OrderDiscussionMessage\r\n        v-for=\"message in messages\"\r\n        :time=\"message.createdAt\"\r\n        :source=\"message.source\"\r\n        :sender=\"message.displayName\"\r\n        :text=\"message.displayText\"\r\n      />\r\n    </div>\r\n    <div class=\"user-message\">\r\n      <InputText\r\n        v-model=\"userMessage\"\r\n        class=\"messagebox\"\r\n        placeholder=\"Введите сообщение\"\r\n      />\r\n      <Button\r\n        label=\"Отправить\"\r\n        @click=\"onSubmit\"\r\n      />\r\n    </div>\r\n  </AppCard>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n.user-message {\r\n  display: flex;\r\n  gap: 10px;\r\n\r\n  .messagebox {\r\n    flex-grow: 1;\r\n  }\r\n}\r\n\r\n.chat-container {\r\n  margin: 20px auto;\r\n  padding: 10px;\r\n}\r\n</style>\r\n"],"names":["service","useService","MessageService","messages","ref","userMessage","onMounted","props","onSubmit"],"mappings":"okBAMMA,EAAUC,EAAWC,CAAc,EACnCC,EAAWC,EAAI,CAAA,CAA0B,EACzCC,EAAcD,EAAI,EAAE,EAE1BE,EAAU,SAAY,CACpBH,EAAS,MAAQ,MAAMH,EAAQ,iBAAiBO,EAAM,OAAO,CAAA,CAC9D,EAED,eAAeC,GAAW,CACnBH,EAAY,QAIbE,EAAM,OAAS,WACjB,MAAMP,EAAQ,mBAAmBO,EAAM,QAASF,EAAY,KAAK,EAEjE,MAAML,EAAQ,gBAAgBO,EAAM,QAASF,EAAY,KAAK,EAGhEA,EAAY,MAAQ,GACpBF,EAAS,MAAQ,MAAMH,EAAQ,iBAAiBO,EAAM,OAAO,EAC/D"}