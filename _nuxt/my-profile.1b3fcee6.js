import{f as V,i as x,l as N,r as n,m as U,s as q,v as F,x as I,j as _,o as c,k as p,w as t,b as r,y as b,A as K}from"./entry.3eeb7ad7.js";import{A as h}from"./AppCard.b8a305ce.js";import{A as S}from"./AppCardGroup.e1de8908.js";import{A as R}from"./AppCardLayout.c0a81ec9.js";import"./_plugin-vue_export-helper.c27b6911.js";const D=V({__name:"my-profile",setup($){const P=x(K),f=N(),v=n(y(!!m())),e=n(null),s=n({newPassword:""}),l=n(m()),w=U(),A=w.afterEach(()=>{l.value=m(),v.value=y(!!l.value)});q(async()=>{e.value=await f.getProfile()}),F(A);function y(u){return[...u?[{$el:"p",children:"Заполните профиль, что бы продолжить работу"}]:[],{$formkit:"primeInputText",name:"fullName",label:"Имя",validation:"required"},{$formkit:"primeInputText",type:"tel",name:"phoneNumber",label:"Телефон",validation:""}]}function m(){const o=I().query.redirectTo;return(Array.isArray(o)?o[0]:o)??""}async function k(){if(console.log(e.value),!e.value)return;const{fullName:u,phoneNumber:a}=e.value;await f.setProfile(u,a),l.value&&w.push(l.value)}const C=[{$formkit:"primePassword",name:"newPassword",label:"Новый парооль",validation:"required",toggleMask:!0}];async function g(){await P.setPassword(s.value.newPassword)}return(u,a)=>{const o=_("FormKitSchema"),i=_("FormKit");return c(),p(R,null,{default:t(()=>[r(S,null,{default:t(()=>[r(h,{title:"Личная информация"},{default:t(()=>[e.value?(c(),p(i,{key:0,modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=d=>e.value=d),type:"form","submit-attrs":{inputClass:"p-button p-component"},onSubmit:k},{default:t(()=>[r(o,{schema:v.value,data:e.value},null,8,["schema","data"])]),_:1},8,["modelValue"])):b("",!0)]),_:1})]),_:1}),r(S,null,{default:t(()=>[r(h,{title:"Изменить пароль"},{default:t(()=>[e.value?(c(),p(i,{key:0,modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=d=>s.value=d),type:"form","submit-attrs":{inputClass:"p-button p-component"},onSubmit:g},{default:t(()=>[r(o,{schema:C,data:e.value},null,8,["data"])]),_:1},8,["modelValue"])):b("",!0)]),_:1})]),_:1})]),_:1})}}});export{D as default};
