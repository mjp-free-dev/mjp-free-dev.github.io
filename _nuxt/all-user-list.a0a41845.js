import{f as b,r as y,i as P,s as B,o as C,k as _,A as n}from"./entry.6f82f3e9.js";import{s as a,a as g,A as N}from"./index.d7976f6d.js";import{S as w}from"./supabase.service.49e6b1a2.js";import"./inputtext.esm.ace789a5.js";import"./dropdown.esm.0e48b34e.js";import"./index.esm.d1a6b219.js";import"./index.esm.63a65999.js";import"./overlayeventbus.esm.0de0701f.js";import"./virtualscroller.esm.cb0603df.js";import"./tristatecheckbox.esm.392f4dcb.js";import"./checkbox.esm.f6afd0e2.js";import"./inputnumber.esm.8fad9cc9.js";import"./button.esm.a41dd05c.js";import"./index.esm.f537a05e.js";import"./AppCard.15c0afdc.js";import"./_plugin-vue_export-helper.c27b6911.js";const J=b({__name:"all-user-list",setup(S){const t=y([]),i=P(w);async function o(){const s=await i.getMany(async e=>e.from("userPublicProfile").select("*, userPrivateProfile(*), userBalance(*), userClaim(*)"));t.value=s.map(e=>{const{id:l,fullName:r,displayId:u}=e,{plnBalance:p}=e.userBalance[0]??e.userBalance,{email:f,phoneNumber:d}=e.userPrivateProfile[0]??e.userPrivateProfile,{accessLevel:v}=(e.userClaim?e.userClaim[0]:null)??e.userClaim??{accessLevel:1};return{id:l,fullName:r,displayId:u,plnBalance:p,email:f,phoneNumber:d,accessLevel:v}})}B(o);async function c(s){const{id:e,accessLevel:l}=s;console.log(e,l),await i.set(async r=>r.from("userClaim").upsert({id:e,accessLevel:l})),await o()}const m={title:"Все пользователи",labels:{id:"",displayId:"#",fullName:"Имя",email:"Email",phoneNumber:"Телефон",plnBalance:"Баланс",accessLevel:"Доступ"},columns:{id:!1,displayId:a,fullName:a,email:a,phoneNumber:a,plnBalance:a,accessLevel:g([{value:1,label:"Пользователь",severity:"info"},{value:2,label:"Модератор",severity:"warning"},{value:3,label:"Администратор",severity:"danger"}])}};return(s,e)=>(C(),_(n(N),{config:m,data:n(t),onRowEditSave:c},null,8,["data"]))}});export{J as default};
