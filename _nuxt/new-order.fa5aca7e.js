import{f,Z as v,l as _,j as y,r as n,o as b,S,w as g,b as w,h as O,aw as V}from"./entry.a1015cae.js";import h from"./new-order-form.dea44f7f.js";import"./product-form.7b89e9b0.js";import"./button.esm.af27022a.js";import"./index.esm.03be2101.js";import"./AppCard.488e347b.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./order-form.cb40f874.js";const j=f({__name:"new-order",setup(k){const r=v(),u=_(),i=y(),s=n(null),o=n({user_id:i.value.id,delivery_type_id:null,comment:"",vat_document_required:!1,products:[{}]});async function l(e){const{error:t}=await u.from("orders").insert([e]);t?r.add({severity:"error",summary:"Ошибка!",detail:JSON.stringify(t,void 0,2)}):r.add({severity:"success",summary:"Заказ создан!"})}function d(e){return e.value.products.length>0}function m(e){o.value.products.splice(e,1)}function c(){o.value.products.push({})}function p(){var e;(e=s.value)==null||e.node.submit()}return(e,t)=>(b(),S(O(V),{ref_key:"form",ref:s,modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=a=>o.value=a),type:"form",validation:"atLeastOneProduct","validation-rules":{atLeastOneProduct:d},"validation-messages":{atLeastOneProduct:"Добавьте хотя бы один товар."},actions:!1,onSubmit:l},{default:g(()=>{var a;return[w(h,{"msg-source":(a=s.value)==null?void 0:a.node,onAdd:c,onDelete:m,onSubmit:p},null,8,["msg-source"])]}),_:1},8,["modelValue","validation-rules","validation-messages"]))}});export{j as default};
