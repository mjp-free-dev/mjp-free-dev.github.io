import{f as y,m as g,q as b,z as h,r as n,o as O,k as S,w as u,b as i,A as V,ac as k}from"./entry.6f82f3e9.js";import w from"./new-order-form.a15b5235.js";import{A}from"./AppCardLayout.9b57ab3b.js";import"./AppCardGroup.02cde9cc.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./product-form.2038af77.js";import"./button.esm.a41dd05c.js";import"./index.esm.63a65999.js";import"./AppCard.15c0afdc.js";import"./order-form.vue.1fbdcfdd.js";const F=y({__name:"new-order",setup(C){const d=g(),r=b(),l=h(),s=n(null),a=n({comment:"",products:[{}],shippingMethodId:null,vatDocumentRequired:!1});async function m(e){const{error:o,data:t}=await l.rpc("addOrder",e);if(o||!t)r.add({severity:"error",summary:"Ошибка!",detail:JSON.stringify(o,void 0,2)});else{const _=t.id;d.push("/user/my-order-info?orderId="+_),r.add({severity:"success",summary:"Заказ создан!"})}}function c(e){return e.value.products.length>0}function p(e){a.value.products.splice(e,1)}function f(){a.value.products.push({})}function v(){var e;(e=s.value)==null||e.node.submit()}return(e,o)=>(O(),S(V(k),{ref_key:"form",ref:s,modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=t=>a.value=t),type:"form",validation:"atLeastOneProduct","validation-rules":{atLeastOneProduct:c},"validation-messages":{atLeastOneProduct:"Добавьте хотя бы один товар."},actions:!1,onSubmit:m},{default:u(()=>[i(A,null,{default:u(()=>{var t;return[i(w,{"msg-source":(t=s.value)==null?void 0:t.node,onAdd:f,onDelete:p,onSubmit:v},null,8,["msg-source"])]}),_:1})]),_:1},8,["modelValue","validation-rules","validation-messages"]))}});export{F as default};
