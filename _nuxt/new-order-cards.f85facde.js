import{f as v,l as _,g as b,r as u,o as g,k as S,w as s,b as a,q as y,D as O,S as h}from"./entry.28d93db7.js";import k from"./new-order-form.4d23ee50.js";import{A as P}from"./AppCardLayout.bc5bc70e.js";import"./index.88c16502.js";import"./AppCardGroup.992821d5.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./product-form.51e6cff3.js";import"./button.esm.c67130ee.js";import"./index.esm.7576e217.js";import"./AppCard.b95f99f4.js";import"./order-form.e0b61a3a.js";import"./WideButton.d78934ac.js";const N=v({__name:"new-order-cards",setup(V){const i=_(),l=b(h),n=u(null),r=u({comment:"",products:[{url:"",count:1,userPriceForOne:null,comment:""}],shippingMethodId:null,vatDocumentRequired:!1});async function c(e){for(const t of e.products)t.url=t.url.trim();const o=await l.set(async t=>t.rpc("addOrder",e),!1,"Заказ создан");o!=null&&o.id&&i.push("/user/my-order-info?orderId="+(o==null?void 0:o.id))}function m(e){return e.value.products.length>0}function d(e){r.value.products.splice(e,1)}function p(){r.value.products.push({url:"",count:1,userPriceForOne:null,comment:""})}function f(){var e;(e=n.value)==null||e.node.submit()}return(e,o)=>(g(),S(y(O),{ref_key:"form",ref:n,modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=t=>r.value=t),type:"form",validation:"atLeastOneProduct","validation-rules":{atLeastOneProduct:m},"validation-messages":{atLeastOneProduct:"Добавьте хотя бы один товар."},actions:!1,onSubmit:c},{default:s(()=>[a(P,null,{default:s(()=>{var t;return[a(k,{"msg-source":(t=n.value)==null?void 0:t.node,onAdd:p,onDelete:d,onSubmit:f},null,8,["msg-source"])]}),_:1})]),_:1},8,["modelValue","validation-rules","validation-messages"]))}});export{N as default};
