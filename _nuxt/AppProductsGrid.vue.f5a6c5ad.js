import{f as r,o as l,k as c,q as d,b as u}from"./entry.52dc1539.js";import{v as f,_ as p,p as m,f as g,s as h,i as _}from"./app-grid.vue.a2deb59e.js";import"./AppCard.e7e64d2e.js";import"./inputtext.esm.48a58b64.js";const b=r({__name:"app-form-grid",props:{data:{},config:{}},setup(i){const t=i,a={title:t.config.title,basis:t.config.basis,allowAdd:()=>{t.data.push((t.config.newItemFunc??(()=>({})))(t.data.length))},allowDelete:n=>{var e;const s=t.data.findIndex(o=>o[t.config.dataKey]===n[t.config.dataKey]);s!==-1&&t.data.splice(s,1),(e=t.config.onDeleted)==null||e.call(void 0,n)},allowEdit:!0,props:{dataKey:t.config.dataKey,editMode:"cell",filterDisplay:void 0},emits:{"cell-edit-complete":n=>t.data[n.index][n.field]=n.newValue},getData:()=>(t.config.onLoaded&&t.config.onLoaded(),Promise.resolve(t.data)),hidePaging:!0,labels:t.config.labels,columns:{$validationOutcome:f(t.config.validationFunc),...t.config.columns}};return(n,s)=>(l(),c(d(p),{data:t.data,config:a},null,8,["data"]))}});function x(i,t){if(i.length<=t)return i;const a=i.split("?")[0],n="...",s=t-n.length,e=a.substr(-s);return n+e}function P(i){return{...g,slots:{body:({data:t,field:a})=>{const n=t[a];if(!n)return[];const s=x(n,i);return[u("a",{target:"_blank",style:"text-decoration: underline;",href:n},[s])]}}}}function w(i){const t=P(i);return{...t,slots:{...t.slots,editor:m}}}const C=r({__name:"AppProductsGrid",props:{items:{},mode:{}},setup(i){const t=i;function a(){var e;for(let o=0;o<((e=t.items)==null?void 0:e.length);o++)t.items[o].id=o+1}const n={basis:"500px",title:"Товары",dataKey:"id",allowAdd:!0,allowEdit:!0,allowDelete:!0,onDeleted:()=>a(),newItemFunc:e=>({id:e+1,count:1}),validationFunc:e=>{const o=[];return(!Number.isFinite(e.count)||e.count<1)&&o.push("Количество должно быть больше либо равно 1"),!e.url||!s(e.url)?o.push("Укажите ссылку на товар в формате https://site.com/some-product"):e.url.length>65536&&o.push("Максимальная длинна ссылки 65536"),o},labels:{id:"#",url:"Ссылка",count:"Количество"},columns:{id:h,url:w(50),count:_}};function s(e){return/^(https?):\/\/(([^:\/?#\s]+)(?::(\d+))?)(\/[^?#\s]*)?(\?[^#\s]*)?(#\S*)?$/i.test(e)}return(e,o)=>(l(),c(d(b),{config:n,data:t.items},null,8,["data"]))}});export{C as _};
