import{f as y,m as g,q as b,B as h,r as n,o as O,k as S,w as u,b as i,z as V,af as k}from"./entry.3eeb7ad7.js";import w from"./new-order-form.d72f0020.js";import{A as C}from"./AppCardLayout.c0a81ec9.js";import"./AppCardGroup.e1de8908.js";import"./_plugin-vue_export-helper.c27b6911.js";import"./product-form.098e7b15.js";import"./button.esm.80d429ee.js";import"./index.esm.2ade5b5f.js";import"./AppCard.b8a305ce.js";import"./order-form.vue.6b87d65d.js";const F=y({__name:"new-order",setup(L){const d=g(),r=b(),l=h(),s=n(null),a=n({comment:"",products:[{}],shippingMethodId:null,vatDocumentRequired:!1});async function m(e){const{error:o,data:t}=await l.rpc("addOrder",e);if(o||!t)r.add({severity:"error",summary:"Ошибка!",detail:JSON.stringify(o,void 0,2)});else{const _=t.id;d.push("/user/my-order-info?orderId="+_),r.add({severity:"success",summary:"Заказ создан!"})}}function c(e){return e.value.products.length>0}function p(e){a.value.products.splice(e,1)}function f(){a.value.products.push({})}function v(){var e;(e=s.value)==null||e.node.submit()}return(e,o)=>(O(),S(V(k),{ref_key:"form",ref:s,modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=t=>a.value=t),type:"form",validation:"atLeastOneProduct","validation-rules":{atLeastOneProduct:c},"validation-messages":{atLeastOneProduct:"Добавьте хотя бы один товар."},actions:!1,onSubmit:m},{default:u(()=>[i(C,null,{default:u(()=>{var t;return[i(w,{"msg-source":(t=s.value)==null?void 0:t.node,onAdd:f,onDelete:p,onSubmit:v},null,8,["msg-source"])]}),_:1})]),_:1},8,["modelValue","validation-rules","validation-messages"]))}});export{F as default};
