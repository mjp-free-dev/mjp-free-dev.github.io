import{f as g,g as V,A as N,r as l,l as q,i as x,m as U,h as F,j as _,o as c,k as f,w as t,b as r,n as b}from"./entry.819b999e.js";import{A as h}from"./AppCard.7faaf166.js";import{A as P}from"./AppCardGroup.c172a573.js";import{A as I}from"./AppCardLayout.b45fbcdf.js";import"./_plugin-vue_export-helper.c27b6911.js";const M=g({__name:"my-profile",setup(K){const s=V(N),v=l(y(!!i())),e=l(null),m=l({newPassword:""}),n=l(i()),w=q(),A=w.afterEach(()=>{n.value=i(),v.value=y(!!n.value)});x(async()=>{e.value=await s.getProfile()}),U(A);function y(u){return[...u?[{$el:"p",children:"Заполните профиль, что бы продолжить работу"}]:[],{$formkit:"primeInputText",name:"fullName",label:"Полное имя",validation:"required"},{$formkit:"primeInputText",type:"tel",name:"phoneNumber",label:"Телефон",validation:""}]}function i(){const o=F().query.redirectTo;return(Array.isArray(o)?o[0]:o)??""}async function S(){if(!e.value)return;const{fullName:u,phoneNumber:a}=e.value;await s.setProfile(u,a),n.value&&w.push(n.value)}const k=[{$formkit:"primePassword",name:"newPassword",label:"Новый парооль",validation:"required",toggleMask:!0}];async function C(){await s.setPassword(m.value.newPassword)}return(u,a)=>{const o=_("FormKitSchema"),d=_("FormKit");return c(),f(I,null,{default:t(()=>[r(P,null,{default:t(()=>[r(h,{title:"Личная информация"},{default:t(()=>[e.value?(c(),f(d,{key:0,modelValue:e.value,"onUpdate:modelValue":a[0]||(a[0]=p=>e.value=p),type:"form","submit-attrs":{inputClass:"p-button p-component"},onSubmit:S},{default:t(()=>[r(o,{schema:v.value,data:e.value},null,8,["schema","data"])]),_:1},8,["modelValue"])):b("",!0)]),_:1})]),_:1}),r(P,null,{default:t(()=>[r(h,{title:"Изменить пароль"},{default:t(()=>[e.value?(c(),f(d,{key:0,modelValue:m.value,"onUpdate:modelValue":a[1]||(a[1]=p=>m.value=p),type:"form","submit-attrs":{inputClass:"p-button p-component"},onSubmit:C},{default:t(()=>[r(o,{schema:k,data:e.value},null,8,["data"])]),_:1},8,["modelValue"])):b("",!0)]),_:1})]),_:1})]),_:1})}}});export{M as default};
